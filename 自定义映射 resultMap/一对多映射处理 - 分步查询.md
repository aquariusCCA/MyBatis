---
up:
  - "[[MyBatis 課程描述]]"
  - "[[一对多映射处理]]"
---

# 1. 查询部门信息

```java
/**
 * 通过分步查询部门以及部门中所有的员工信息
 * 分步查询第一步：查询部门信息
 */
Dept getDeptAndEmpByStepOne(@Param("did") Integer did);
```

```xml
<resultMap id="deptAndEmpByStepResultMap" type="Dept">
	<id property="did" column="did" />
	<id property="deptName" column="dept_name" />
	<collection 
		property="emps"
		select="com.atguigu.mybatis.mapper.EmpMapper.getDeptAndEmpByStepTwo"
		column="did" 
		fetchType="eager"
	>
	</collection>
</resultMap>

<!-- Dept getDeptAndEmpByStepOne(@Param("did") Integer did); -->
<select id="getDeptAndEmpByStepOne" resultMap="deptAndEmpByStepResultMap">
	select * from t_dept where did = #{did}
</select>
```

---

# 2. 根据部门 id 查询部门中的所有员工

```java
/**  
 * 通过分步查询部门以及部门中所有的员工信息  
 * 分步查询第二步：根据did查询员工信息  
 */  
List<Emp> getDeptAndEmpByStepTwo(@Param("did") Integer did);
```

```xml
<!-- List<Emp> getDeptAndEmpByStepTwo(@Param("did") Integer did); -->  
<select id="getDeptAndEmpByStepTwo" resultType="Emp">  
    select * from t_emp where did = #{did}  
</select>
```

---

# 3. 測試

```java
@Test  
public void testGetDeptAndEmpByStep() {  
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();  
    DeptMapper mapper = sqlSession.getMapper(DeptMapper.class);  
    Dept dept = mapper.getDeptAndEmpByStepOne(1);  
    System.out.println(dept.getDeptName());  
}
```

---