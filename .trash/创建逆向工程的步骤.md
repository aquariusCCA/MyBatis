---
up:
  - "[[MyBatis 課程描述]]"
  - "[[MyBatis 的逆向工程]]"
---
# 添加依赖和插件

```xml
<dependencies>
	<!-- MyBatis核心 -->
	<dependency>
		<groupId>org.mybatis</groupId>
		<artifactId>mybatis</artifactId>
		<version>3.5.7</version>
	</dependency>

	<!-- juint测试 -->
	<dependency>
		<groupId>junit</groupId>
		<artifactId>junit</artifactId>
		<version>4.12</version>
		<scope>test</scope>
	</dependency>

	<!-- MySQL驱动 -->
	<dependency>
		<groupId>mysql</groupId>
		<artifactId>mysql-connector-java</artifactId>
		<version>8.0.30</version>
	</dependency>

	<!-- Lombok -->
	<dependency>
		<groupId>org.projectlombok</groupId>
		<artifactId>lombok</artifactId>
		<version>1.18.34</version>
	</dependency>

	<!-- Logback -->
	<dependency>
		<groupId>ch.qos.logback</groupId>
		<artifactId>logback-classic</artifactId>
		<version>1.5.6</version>
	</dependency>
</dependencies>

<!-- 控制Maven在构建过程中相关配置 -->
<build>
	<plugins>
		<!-- MyBatis Generator 外掛：執行期需要 JDBC Driver（注意是放在 plugin 的 dependencies 裡） -->
		<plugin>
			<groupId>org.mybatis.generator</groupId>
			<artifactId>mybatis-generator-maven-plugin</artifactId>
			<version>1.4.2</version>
			<configuration>
				<configurationFile>src/main/resources/generatorConfig.xml</configurationFile>
				<overwrite>true</overwrite> <!-- 開發期方便直接覆蓋；上線前請改走部分重生策略 -->
				<verbose>true</verbose>
			</configuration>
			<dependencies>
				<!-- 供「外掛執行」時連 DB 用的 Driver（與上方運行期依賴相互獨立） -->
				<dependency>
					<groupId>mysql</groupId>
					<artifactId>mysql-connector-java</artifactId>
					<version>8.0.30</version>
				</dependency>
			</dependencies>
		</plugin>
	</plugins>
</build>
```

---

# 创建 MyBatis 的核心配置文件

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE configuration
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-config.dtd">
<configuration>
    <properties resource="jdbc.properties"/>

    <settings>
        <!-- SLF4J -->
        <setting name="logImpl" value="SLF4J"/>
    </settings>

    <typeAliases>
        <package name=""/>
    </typeAliases>

    <environments default="development">
        <environment id="development">
            <transactionManager type="JDBC"/>
            <dataSource type="POOLED">
                <property name="driver" value="${jdbc.driver}"/>
                <property name="url" value="${jdbc.url}"/>
                <property name="username" value="${jdbc.username}"/>
                <property name="password" value="${jdbc.password}"/>
            </dataSource>
        </environment>
    </environments>

    <mappers>
        <package name=""/>
    </mappers>
</configuration>
```

---

# 创建逆向工程的配置文件

> 文件名必须是：`generatorConfig.xml`

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE generatorConfiguration
        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"
        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd">
<generatorConfiguration>
    <context id="MySQL-MBG" targetRuntime="MyBatis3">

        <!-- 1) 可選：全域屬性、外掛、註解產生器（此處略） -->

        <!-- 2) 連線：必須先於 javaTypeResolver -->
        <jdbcConnection driverClass="com.mysql.cj.jdbc.Driver"
                        connectionURL="jdbc:mysql://localhost:3306/mybatis"
                        userId="root"
                        password="Lins860210SStar">
        </jdbcConnection>

        <!-- 3) 型別解析：順序必須在 jdbcConnection 之後 -->
        <javaTypeResolver>
            <property name="forceBigDecimals" value="false"/>
            <property name="useJSR310Types"   value="true"/>
            <!-- 如需處理 tinyint(1)->boolean 的議題，再另行調整；此處先用欄位級覆寫 -->
        </javaTypeResolver>

        <!-- 4) Java 實體輸出 -->
        <javaModelGenerator targetPackage="com.atguigu.mybatis.pojo"
                            targetProject="./src/main/java">
            <property name="enableSubPackages" value="true"/>
            <property name="trimStrings"       value="true"/>
        </javaModelGenerator>

        <!-- 5) XML 映射輸出（可選但常用） -->
        <sqlMapGenerator targetPackage="com.atguigu.mybatis.mapper"
                         targetProject="./src/main/resources">
            <property name="enableSubPackages" value="true"/>
        </sqlMapGenerator>

        <!-- 6) Mapper 介面輸出（可選） -->
        <javaClientGenerator type="XMLMAPPER"
                             targetPackage="com.atguigu.mybatis.mapper"
                             targetProject="./src/main/java">
            <property name="enableSubPackages" value="true"/>
        </javaClientGenerator>

        <!-- 7) 表：**至少一個**，放在最後；開啟 *ByExample 系列 -->
        <table tableName="t_emp" domainObjectName="Emp"
               enableSelectByExample="true"
               enableDeleteByExample="true"
               enableCountByExample="true"
               enableUpdateByExample="true">
            <!-- 避免 sex 被映射成 Byte/Boolean，顯式指定為 Integer -->
            <columnOverride column="sex" javaType="java.lang.Integer"/>
        </table>

        <table tableName="t_dept" domainObjectName="Dept"
               enableSelectByExample="true"
               enableDeleteByExample="true"
               enableCountByExample="true"
               enableUpdateByExample="true"/>
    </context>
</generatorConfiguration>
```

---

# 执行 MBG 插件的 generate 目标

![](执行MBG插件的generate目标.png)

如果出现报错：`Exception getting JDBC Driver`，可能是 pom.xml 中，数据库驱动配置错误
-   dependency 中的驱动![](dependency中的驱动.png)
-   mybatis-generator-maven-plugin 插件中的驱动
	  ![](插件中的驱动.png)
    -   两者的驱动版本应该相同